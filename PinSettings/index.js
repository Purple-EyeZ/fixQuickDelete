(function(p,o,S,t,F,O,l,U,c,I){"use strict";const{intl:P,t:v}=S.findByProps("intl")??{},{runtimeHashMessageKey:y}=S.findByProps("runtimeHashMessageKey")??{},m=!!t.i18n.Messages.DISCORD||!P||!v||!y,g={},$=Object.freeze(new Proxy(g,{get(n,r,s){const e=r.toString();if(e in g)return Reflect.get(n,e,s);if(m)return g[e]=t.i18n.Messages[e];const i=y(e);try{return g[e]=P.string(v[i])}catch(a){return console.warn(`intlProxy: Failed to get intl message for key: ${e} (${i})`,a),g[e]=""}}})),u={};Object.freeze(new Proxy(u,{get(n,r,s){const e=r.toString();if(e in u)return Reflect.get(n,e,s);if(m)return u[e]=typeof t.i18n.Messages[e]=="string"?function(){return t.i18n.Messages[e]}:t.i18n.Messages[e].format;const i=y(e);try{return u[e]=function(a){return P.format(v[i],a)}}catch(a){return console.warn(`intlFormat: Failed to get intl format message for key: ${e} (${i})`,a),u[e]=function(){return""}}}}));const{FormRow:R}=l.Forms;function M(n){let{plugin:r,forceUpdate:s}=n;const e=c.getSettings(r.id),i=t.NavigationNative.useNavigation();return t.React.createElement(R,{label:r.manifest.name,leading:t.React.createElement(R.Icon,{source:I.getAssetIDByName(r.manifest.vendetta?.icon??"ic_application_command_24px")}),trailing:R.Arrow,onPress:function(){return r.enabled?i.push("VendettaCustomPage",{title:r.manifest.name,render:e}):s()}})}const{FormSection:N,FormDivider:B}=l.Forms;function _(){U.useProxy(o.storage);const n=Object.keys(o.storage.pinnedPlugins),r=window.hasOwnProperty("enmity")||window.hasOwnProperty("Aliucord"),[,s]=t.React.useReducer(function(i){return~i},0);if(n.length===0)return null;const e=n.filter(function(i){return c.plugins[i]&&c.plugins[i].enabled}).map(function(i,a){return t.React.createElement(t.React.Fragment,null,t.React.createElement(M,{plugin:c.plugins[i],forceUpdate:s}),a!==n.length-1&&t.React.createElement(B,null))});return o.storage.appendExisting?t.React.createElement(l.ErrorBoundary,null,e):t.React.createElement(l.ErrorBoundary,null,t.React.createElement(N,{key:"PinSettingsPlugins",title:`${r?"Vendetta ":""}Plugins`},e))}const h=S.findByName("UserSettingsOverviewWrapper",!1);console.log("[PinSettings] Found settingsModule:",h);function j(){if(!h)return console.error("[PinSettings] Failed to find UserSettingsOverviewWrapper"),function(){};const n=[];console.log("[PinSettings] Patching UserSettingsOverviewWrapper...");const r=F.after("default",h,function(s,e){if(console.log("[PinSettings] Inside after hook for UserSettingsOverviewWrapper. Result:",e),!e||!e.props||!e.props.children){console.error("[PinSettings] Unexpected structure in settingsModule render:",e);return}console.log("[PinSettings] UserSettingsOverviewWrapper render tree:",e.props.children);const i=O.findInReactTree(e.props.children,function(a){return a.type?.name==="UserSettingsOverview"});if(!i){console.error("[PinSettings] Failed to find UserSettingsOverview in settingsModule:"),console.log("[PinSettings] settingsModule render tree:",e.props.children);return}console.log("[PinSettings] Found UserSettingsOverview:",i),n.push(F.after("render",i.type.prototype,function(a,d){if(console.log("[PinSettings] Inside render hook for UserSettingsOverview, result:",d),!d?.props?.children){console.error("[PinSettings] Unexpected structure in render result:",d);return}const f=O.findInReactTree(d.props.children,function(E){return E?.children?.[1]?.type===l.Forms.FormSection})?.children;if(!f){console.error("[PinSettings] Failed to find settings children");return}console.log("[PinSettings] Found settings children:",f);const x=[$.BILLING_SETTINGS,$.PREMIUM_SETTINGS];console.log("[PinSettings] Settings titles for injection:",x);const w=f.findIndex(function(E){return x.includes(E?.props?.label)});console.log("[PinSettings] Injecting at index:",w),f.splice(w===-1?4:w,0,React.createElement(_,null)),console.log("[PinSettings] SettingsSection successfully injected.")})),console.log("[PinSettings] Unpatching UserSettingsOverviewWrapper..."),r()});return console.log("[PinSettings] Patch applied to UserSettingsOverviewWrapper."),function(){console.log("[PinSettings] Cleaning up patches..."),n.forEach(function(s){return s()})}}const{FormRow:T,FormRadioRow:W}=l.Forms;function k(n){let{name:r,id:s}=n;const e=o.storage.pinnedPlugins[s];return React.createElement(W,{label:r,trailing:T.Arrow,selected:e,onPress:function(){e?delete o.storage.pinnedPlugins[s]:o.storage.pinnedPlugins[s]=!0}})}const{FormRow:A,FormSection:b,FormSwitchRow:C,FormDivider:D}=l.Forms;function V(){return U.useProxy(o.storage),t.React.createElement(t.ReactNative.ScrollView,{style:{flex:1},contentContainerStyle:{paddingBottom:38}},t.React.createElement(b,{title:"Options",titleStyleType:"no_border"},t.React.createElement(C,{label:"Append to Vendetta section",subLabel:"May be incompatible with other client mods.",leading:t.React.createElement(A.Icon,{source:I.getAssetIDByName("ic_edit_24px")}),value:o.storage.appendExisting,onValueChange:function(n){o.storage.appendExisting=n}})),t.React.createElement(b,{title:"Plugins"},t.React.createElement(t.ReactNative.FlatList,{data:Object.values(c.plugins).filter(function(n){return c.getSettings(n.id)}),ItemSeparatorComponent:D,renderItem:function(n){let{item:r}=n;return t.React.createElement(k,{name:r.manifest.name,id:r.id})}})))}o.storage.pinnedPlugins??={},o.storage.appendExisting??=!1;const L=[j()],G=function(){return L.forEach(function(n){return n()})};return p.onUnload=G,p.settings=V,p})({},vendetta.plugin,vendetta.metro,vendetta.metro.common,vendetta.patcher,vendetta.utils,vendetta.ui.components,vendetta.storage,vendetta.plugins,vendetta.ui.assets);
